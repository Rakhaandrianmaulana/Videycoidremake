<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Exambro - Verification</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Animasi Background Gradient */
        body {
            background: linear-gradient(-45deg, #141e30, #243b55, #4b6cb7, #182848);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            height: 100vh;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none; /* Mencegah seleksi teks saat geser */
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Glassmorphism Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        /* Center Slider Styles */
        #slider-container {
            position: relative;
            width: 100%;
            height: 64px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 32px;
            display: flex;
            align-items: center;
            justify-content: space-between; /* Space text to sides */
            padding: 0 20px;
            border: 2px solid rgba(255,255,255,0.1);
            box-sizing: border-box;
            overflow: hidden;
        }

        /* Labels Kiri & Kanan */
        .slider-label {
            font-weight: bold;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 1;
            transition: opacity 0.3s;
        }

        /* The Handle (Tombol Geser) */
        #slider-handle {
            position: absolute;
            left: 50%; /* Start in middle */
            top: 50%;
            transform: translate(-50%, -50%); /* Center perfectly */
            width: 56px;
            height: 56px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            z-index: 10;
            transition: background 0.3s; /* Smooth color change */
            /* Note: 'left' is handled by JS during drag, 'transform' centers it */
        }

        #slider-handle:active {
            cursor: grabbing;
            transform: translate(-50%, -50%) scale(0.95);
        }

        #slider-handle i {
            color: #243b55;
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        /* Confetti */
        #confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
        }

        /* Animation for appearance */
        .fade-in-up {
            animation: fadeInUp 0.5s forwards;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="flex items-center justify-center">

    <canvas id="confetti-canvas"></canvas>

    <div class="glass-card p-8 w-full max-w-md mx-4 text-center relative z-20">
        <!-- Logo Area -->
        <div class="mb-8">
            <div class="w-20 h-20 mx-auto bg-gradient-to-tr from-blue-400 to-purple-500 rounded-2xl flex items-center justify-center shadow-lg mb-4 rotate-3 hover:rotate-0 transition-all duration-300">
                <i class="fa-solid fa-file-shield text-4xl text-white"></i>
            </div>
            <h1 class="text-2xl font-bold text-white tracking-wide">Exambro Secure</h1>
            <p class="text-blue-200 text-xs mt-1 font-mono">VERSI 4.0.2 // BUILD 2024</p>
        </div>

        <!-- Question -->
        <div id="question-area" class="mb-2">
            <h2 class="text-white font-semibold text-lg mb-6">Apakah Lana Ganteng?</h2>
            
            <!-- The Slider -->
            <div id="slider-container">
                <span class="slider-label text-red-400"><i class="fa-solid fa-xmark mr-1"></i> GAK</span>
                
                <div id="slider-handle">
                    <i class="fa-solid fa-arrows-left-right"></i>
                </div>
                
                <span class="slider-label text-green-400">IYA <i class="fa-solid fa-check ml-1"></i></span>
            </div>
            <p id="hint-text" class="text-white/40 text-xs mt-3">Geser ke jawaban yang benar</p>
        </div>

        <!-- Download Section (Hidden Initially) -->
        <div id="download-area" class="hidden mt-4">
            <div class="bg-green-500/10 border border-green-500/30 rounded-xl p-4 mb-4 fade-in-up">
                <div class="flex items-center justify-center gap-2 text-green-300 font-bold mb-1">
                    <i class="fa-solid fa-shield-halved"></i> AKSES DITERIMA
                </div>
                <p class="text-green-100/70 text-xs">Jawaban Anda benar. Lana Valid Ganteng.</p>
            </div>
            
            <a href="base.apk" download class="fade-in-up block w-full bg-white hover:bg-blue-50 text-blue-900 font-bold py-4 rounded-xl shadow-lg transition transform hover:-translate-y-1 active:scale-95 flex items-center justify-center gap-3">
                <i class="fa-solid fa-cloud-arrow-down text-xl"></i>
                DOWNLOAD APLIKASI
            </a>
            <button onclick="location.reload()" class="mt-4 text-white/30 text-xs hover:text-white underline">Reset Verifikasi</button>
        </div>

    </div>

    <script>
        const container = document.getElementById('slider-container');
        const handle = document.getElementById('slider-handle');
        const handleIcon = handle.querySelector('i');
        const questionArea = document.getElementById('question-area');
        const downloadArea = document.getElementById('download-area');
        const hintText = document.getElementById('hint-text');

        let isDragging = false;
        let startX, startLeft;
        
        // Dimensions
        let containerWidth, handleWidth, maxDist;

        function initDimensions() {
            containerWidth = container.offsetWidth;
            handleWidth = handle.offsetWidth;
            // Jarak maksimal dari tengah ke pinggir (dikurangi sedikit padding)
            maxDist = (containerWidth / 2) - (handleWidth / 2) - 4;
        }

        // Init
        initDimensions();
        window.addEventListener('resize', initDimensions);

        // Mouse Events
        handle.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', endDrag);

        // Touch Events
        handle.addEventListener('touchstart', (e) => startDrag(e.touches[0]));
        document.addEventListener('touchmove', (e) => drag(e.touches[0]));
        document.addEventListener('touchend', endDrag);

        function startDrag(e) {
            if (handle.classList.contains('locked')) return; // Stop if already verified
            
            isDragging = true;
            startX = e.clientX;
            handle.style.transition = 'none'; // Remove transition for instant drag
        }

        function drag(e) {
            if (!isDragging) return;
            
            let moveX = e.clientX - startX;

            // Limit movement
            if (moveX > maxDist) moveX = maxDist;
            if (moveX < -maxDist) moveX = -maxDist;

            // Apply movement (TranslateX)
            // Note: We use translate(-50%, -50%) for centering + translateX(moveX) for movement
            handle.style.transform = `translate(calc(-50% + ${moveX}px), -50%)`;

            // Visual feedback
            if (moveX > 0) {
                // Dragging Right (YES)
                handle.style.background = `rgba(${255 - (moveX/maxDist)*255}, 255, ${255 - (moveX/maxDist)*255}, 1)`; // White to Greenish logic handled better below
                container.style.background = `linear-gradient(90deg, rgba(0,0,0,0.4) 50%, rgba(46, 204, 113, ${moveX/maxDist * 0.5}) 100%)`;
                handleIcon.className = "fa-solid fa-face-smile";
            } else if (moveX < 0) {
                // Dragging Left (NO)
                container.style.background = `linear-gradient(90deg, rgba(231, 76, 60, ${Math.abs(moveX)/maxDist * 0.5}) 0%, rgba(0,0,0,0.4) 50%)`;
                handleIcon.className = "fa-solid fa-face-frown";
            }
        }

        function endDrag(e) {
            if (!isDragging) return;
            isDragging = false;
            
            // Re-enable transition for snap back
            handle.style.transition = 'transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), background 0.3s';
            container.style.transition = 'background 0.3s';

            // Check position
            // Calculate final offset based on the last transform or reconstruct from event
            // Simplified: we track the last intended MoveX implicitly or just grab X from event relative to start
            // Since `drag` updates the visual, let's just calculate based on where the mouse ended up relative to startX
            
            let finalX = (e.changedTouches ? e.changedTouches[0].clientX : e.clientX) - startX;
            
            // Threshold (70% of distance)
            const threshold = maxDist * 0.7;

            if (finalX > threshold) {
                // SUKSES (KANAN)
                verifySuccess();
            } else if (finalX < -threshold) {
                // GAGAL (KIRI)
                verifyFail();
            } else {
                // Snap Back to Center
                resetSlider();
            }
        }

        function resetSlider() {
            handle.style.transform = `translate(-50%, -50%)`;
            handle.style.background = "white";
            container.style.background = "rgba(0, 0, 0, 0.4)";
            handleIcon.className = "fa-solid fa-arrows-left-right";
            handleIcon.style.color = "#243b55";
        }

        function verifyFail() {
            // Visual feedback for Failure
            handle.style.transform = `translate(-50%, -50%)`; // Snap back
            handle.style.background = "#e74c3c"; // Red
            handleIcon.className = "fa-solid fa-xmark";
            handleIcon.style.color = "white";
            hintText.innerText = "Jawaban Salah! Coba lagi.";
            hintText.classList.add('text-red-300');
            
            // Reset after 1 second
            setTimeout(() => {
                resetSlider();
                hintText.innerText = "Geser ke jawaban yang benar";
                hintText.classList.remove('text-red-300');
            }, 1000);
        }

        function verifySuccess() {
            handle.style.transform = `translate(calc(-50% + ${maxDist}px), -50%)`;
            handle.style.background = "#2ecc71"; // Green
            handleIcon.className = "fa-solid fa-check";
            handleIcon.style.color = "white";
            handle.classList.add('locked'); // Prevent dragging
            
            startConfetti();

            setTimeout(() => {
                questionArea.style.display = 'none';
                downloadArea.classList.remove('hidden');
            }, 600);
        }

        // --- Confetti Script ---
        const canvas = document.getElementById("confetti-canvas");
        const ctx = canvas.getContext("2d");
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        function startConfetti() {
            for(let i=0; i<120; i++) {
                particles.push({
                    x: window.innerWidth / 2, // Start from center X
                    y: window.innerHeight / 2, // Start from center Y
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 8 + 3,
                    life: 100
                });
            }
            animateConfetti();
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.5; // Gravity
                p.vx *= 0.95; // Friction
                p.vy *= 0.95;
                p.life--;
                p.size *= 0.97;

                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();

                if (p.life <= 0 || p.size < 0.5) {
                    particles.splice(i, 1);
                }
            }

            if(particles.length > 0) requestAnimationFrame(animateConfetti);
        }
    </script>
</body>
</html>
